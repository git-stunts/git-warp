// Fig 2. Two-Plane State Model
// Style: WARP graph vocabulary (ii)
// Shows: Skeleton plane (graph topology via OR-Set) above,
//        Attachment plane (property fibres via LWW) below

digraph two_plane {
  bgcolor=transparent
  rankdir=TB
  fontname="Times-Roman"
  fontsize=11
  label=<<I>Fig. 2.  Two-Plane State Model â€” skeleton topology + attachment fibres</I>>
  labelloc=b
  labeljust=c
  compound=true
  nodesep=1.0
  ranksep=0.8

  node [fontname="Times-Roman", fontsize=10, penwidth=0.8]
  edge [fontname="Times-Roman", fontsize=8, penwidth=0.8]

  // === Skeleton Plane ===
  subgraph cluster_skeleton {
    label=<<B>Skeleton plane G</B>  (OR-Set: add wins over concurrent remove)>
    labelloc=t
    style=rounded
    color="#606060"
    penwidth=0.8
    fontname="Times-Roman"
    fontsize=9

    v1 [shape=circle, style=filled, fillcolor="#d0d0d0", penwidth=1.0,
        label=<v<SUB>1</SUB>>, width=0.5]
    v2 [shape=circle, style=filled, fillcolor="#d0d0d0", penwidth=1.0,
        label=<v<SUB>2</SUB>>, width=0.5]
    v3 [shape=circle, style=filled, fillcolor="#d0d0d0", penwidth=1.0,
        label=<v<SUB>3</SUB>>, width=0.5]

    v1 -> v2 [penwidth=1.2, label=<e<SUB>12</SUB>>]
    v2 -> v3 [penwidth=1.2, label=<e<SUB>23</SUB>>]
    v3 -> v1 [penwidth=1.2, label=<e<SUB>31</SUB>>]
  }

  // === Attachment Plane ===
  subgraph cluster_attach {
    label=<<B>Attachment fibres &#945;, &#946;</B>  (LWW registers, keyed by EventId)>
    labelloc=t
    style=rounded
    color="#606060"
    penwidth=0.8
    fontname="Times-Roman"
    fontsize=9

    a_v1 [shape=box, style="dashed,filled", fillcolor="#f0f0f0",
          label=<&#945;(v<SUB>1</SUB>)<BR/><FONT POINT-SIZE="8">name = "alice"<BR/>role = "admin"</FONT>>]
    a_v2 [shape=box, style="dashed,filled", fillcolor="#f0f0f0",
          label=<&#945;(v<SUB>2</SUB>)<BR/><FONT POINT-SIZE="8">name = "bob"</FONT>>]
    a_v3 [shape=box, style="dashed,filled", fillcolor="#f0f0f0",
          label=<&#945;(v<SUB>3</SUB>)<BR/><FONT POINT-SIZE="8">name = "carol"</FONT>>]
    b_e12 [shape=box, style="dashed,filled", fillcolor="#f0f0f0",
           label=<&#946;(e<SUB>12</SUB>)<BR/><FONT POINT-SIZE="8">weight = 1.0</FONT>>]

    // Atoms inside attachment boxes
    atom1 [shape=point, width=0.08, fillcolor="#a0a0a0", color="#a0a0a0"]
    atom2 [shape=point, width=0.08, fillcolor="#a0a0a0", color="#a0a0a0"]

    a_v1 -> atom1 [style=invis, minlen=0]
    a_v3 -> atom2 [style=invis, minlen=0]
  }

  // === Dashed attachment lines connecting planes ===
  v1 -> a_v1 [style=dashed, penwidth=0.5, color="#606060", label="&#945;", fontsize=8]
  v2 -> a_v2 [style=dashed, penwidth=0.5, color="#606060", label="&#945;", fontsize=8]
  v3 -> a_v3 [style=dashed, penwidth=0.5, color="#606060", label="&#945;", fontsize=8]
  // Graphviz cannot source edges from edges; label clarifies the semantic
  v1 -> b_e12 [style=dashed, penwidth=0.5, color="#606060",
               label=<&#946;(e<SUB>12</SUB>)>, fontsize=8,
               ltail=cluster_skeleton]
}
